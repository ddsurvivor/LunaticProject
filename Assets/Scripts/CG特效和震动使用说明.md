# CG特效和震动功能使用说明

## 🎬 新增功能

### 1. CG淡入淡出效果
CG切换时支持多种淡入淡出效果，让画面过渡更加流畅自然。

### 2. 画面震动效果
支持让整个剧本界面震动，可用于表现爆炸、地震等场景。

---

## 📋 命令总览

| 命令 | 功能 | 示例 |
|------|------|------|
| `CG(图片名)` | 切换CG（默认淡出淡入） | `CG(battle_scene)` |
| `CG(图片名,类型)` | 切换CG（指定效果） | `CG(forest,1)` |
| `CG(图片名,类型,时长)` | 切换CG（自定义时长） | `CG(castle,3,1.0)` |
| `SHAKE()` | 震动（默认参数） | `SHAKE()` |
| `SHAKE(强度)` | 震动（指定强度） | `SHAKE(30)` |
| `SHAKE(强度,时长)` | 震动（指定强度和时长） | `SHAKE(40,1.0)` |
| `SHAKE(强度,时长,次数)` | 震动（完整参数） | `SHAKE(50,0.8,15)` |

---

## 🎨 CG淡入淡出详解

### 基本语法

```
CG(图片名称)                    # 使用默认淡出后淡入效果
CG(图片名称, 淡入淡出类型)      # 指定效果类型
CG(图片名称, 淡入淡出类型, 时长) # 完全自定义
```

### 淡入淡出类型

| 类型 | 效果 | 说明 | 适用场景 |
|------|------|------|----------|
| 0 | 无效果 | 直接切换，无过渡 | 快速切换，无需动画 |
| 1 | 仅淡入 | 新图片从透明渐显 | 场景首次显示 |
| 2 | 仅淡出 | 旧图片渐隐后切换 | 场景结束 |
| 3 | 淡出后淡入 | 旧图淡出→新图淡入（默认） | 常规场景切换 |

### 参数说明

**图片名称：** 不含扩展名，从 `Resources/CG/` 文件夹加载

**时长：** 单位为秒（float类型）
- 类型3（淡出后淡入）：总时长会平分为淡出和淡入各一半
- 例如：时长1.0秒 = 淡出0.5秒 + 淡入0.5秒
- 默认时长：0.5秒（可在Inspector中修改 `CG淡入淡出时间` 字段）

### 使用示例

#### 示例1：默认效果
```
CG(opening_scene)
```
效果：淡出后淡入，使用默认时长（0.5秒）

#### 示例2：无过渡切换
```
CG(battle_bg,0)
```
效果：立即切换，无动画

#### 示例3：仅淡入
```
CG(forest,1)
```
效果：新场景从透明渐显

#### 示例4：仅淡出
```
CG(ending,2)
```
效果：当前场景渐隐后切换

#### 示例5：自定义时长
```
CG(dramatic_scene,3,2.0)
```
效果：淡出后淡入，总共2秒（淡出1秒+淡入1秒）

#### 示例6：组合使用
```
CG(battle_start,3,1.0)+SOUND(battle_horn,1)+SHAKE(30,0.5)
```
效果：
1. CG淡出淡入切换（1秒）
2. 同时播放战斗号角循环音效
3. 同时震动0.5秒

---

## 💥 画面震动详解

### 基本语法

```
SHAKE()                         # 默认震动
SHAKE(强度)                     # 自定义强度
SHAKE(强度, 时长)               # 自定义强度和时长
SHAKE(强度, 时长, 震动次数)     # 完整自定义
```

### 参数说明

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| 强度 | float | 20 | 震动的幅度（像素），数值越大震动越剧烈 |
| 时长 | float | 0.5 | 震动持续时间（秒） |
| 震动次数 | int | 10 | 震动的次数，影响震动的频率 |

### 震动强度参考

| 强度值 | 效果 | 适用场景 |
|--------|------|----------|
| 5-10 | 轻微震动 | 脚步声、轻微碰撞 |
| 15-25 | 中等震动 | 爆炸、重击 |
| 30-50 | 强烈震动 | 地震、大爆炸 |
| 50+ | 剧烈震动 | 灾难性事件 |

### 使用示例

#### 示例1：默认震动
```
SHAKE()
```
效果：强度20，持续0.5秒，震动10次

#### 示例2：自定义强度
```
SHAKE(30)
```
效果：强度30的震动，其他参数使用默认值

#### 示例3：自定义强度和时长
```
SHAKE(40,1.0)
```
效果：强度40，持续1秒

#### 示例4：完整自定义
```
SHAKE(50,0.8,15)
```
效果：强度50，持续0.8秒，震动15次（频率较高）

#### 示例5：组合使用
```
SOUND(explosion)+SHAKE(45,0.6,12)
```
效果：播放爆炸音效的同时震动画面

---

## 🎯 实战场景示例

### 场景1：战斗开始
```
CG(battle_bg,3,1.0)+MUSIC(battle_bgm)
旁白:战斗开始！
SOUND(sword_clash)+SHAKE(25,0.3)
旁白:武器碰撞产生了火花
```

### 场景2：地震场景
```
CG(city,3)
旁白:平静的城市
SHAKE(15,0.5)
旁白:忽然感到轻微的震动
SHAKE(35,1.0,15)
旁白:地震来了！
SOUND(rumble,1)+SHAKE(50,2.0,20)
旁白:震动越来越强烈
SOUND(rumble,0)+SHAKE(20,0.5)
旁白:震动渐渐平息
```

### 场景3：魔法爆炸
```
角色A:看我的魔法！
SOUND(magic_charge,1)
旁白:魔力开始聚集
SOUND(magic_charge,0)+SOUND(explosion)+SHAKE(60,0.4,8)+CG(explosion_effect,1,0.3)
旁白:轰！
```

### 场景4：场景过渡
```
CG(scene1,3,0.8)
旁白:你来到了森林
SOUND(birds,1)
旁白:探索了一会儿
SOUND(birds,0)
CG(scene2,3,1.2)
旁白:你离开了森林，来到了山脚
```

### 场景5：快速切换
```
CG(flash1,0)
!DONTSPAWN+SHAKE(10,0.1,3)
CG(flash2,0)
!DONTSPAWN+SHAKE(10,0.1,3)
CG(final_scene,3,0.5)
旁白:一连串的画面在脑海中闪过
```

---

## ⚙️ Inspector设置

在Unity Inspector中，剧本System组件有以下新设置：

### 特效设置

1. **CG淡入淡出时间** (float)
   - 默认值：0.5秒
   - 说明：CG切换时的默认淡入淡出时间
   - 可以在运行时通过参数覆盖

2. **震动目标** (RectTransform)
   - 说明：指定要震动的对象
   - 建议设置：整个剧本界面的根RectTransform
   - 如果未设置：会震动剧本System所在的GameObject

### 设置步骤

1. 在Hierarchy中选择剧本System所在的GameObject
2. 在Inspector中找到"特效设置"部分
3. 设置 `CG淡入淡出时间`（可选，默认0.5秒）
4. 将要震动的对象拖到 `震动目标` 字段（推荐设置）

**震动目标推荐设置：**
- 整个Canvas下的主Panel
- 剧本UI的根GameObject
- 确保是RectTransform类型

---

## 📝 注意事项

### CG淡入淡出

1. **图片必须在Resources文件夹**
   - 路径：`Assets/Resources/CG/`
   - 支持格式：Unity支持的图片格式（png, jpg等）

2. **性能考虑**
   - 淡入淡出使用DOTween动画
   - 避免过于频繁的切换
   - 过长的淡入淡出时间可能影响体验

3. **颜色保持**
   - 淡入淡出会修改Image的alpha通道
   - 确保Image的Color设置为白色(1,1,1,1)

### 画面震动

1. **震动目标设置**
   - 强烈建议在Inspector中设置震动目标
   - 未设置时会震动剧本System的transform
   - 确保震动目标是RectTransform

2. **震动强度建议**
   - 不要过度使用震动效果
   - 强度过大可能导致不适
   - 根据场景选择合适的参数

3. **连续震动**
   - 可以连续调用SHAKE命令
   - 新的震动会覆盖旧的震动
   - 建议等前一个震动结束后再执行下一个

4. **性能影响**
   - DOTween的震动效果性能良好
   - 但过多同时震动可能影响性能
   - 建议同时最多1-2个震动效果

---

## 🔧 高级技巧

### 技巧1：震动配合音效
```
SOUND(thunder)+SHAKE(30,0.4,8)
```
让音效和震动同步，增强沉浸感

### 技巧2：渐强的震动
```
SHAKE(15,0.3)
旁白:震动开始了
SHAKE(25,0.5)
旁白:震动变强了
SHAKE(40,0.8)
旁白:达到了顶峰！
```

### 技巧3：CG配合震动
```
CG(explosion,1,0.2)+SHAKE(50,0.5,10)
```
快速淡入配合震动，增强冲击感

### 技巧4：无缝场景切换
```
CG(scene1,2,0.5)      # 淡出当前场景
SHAKE(5,0.2,3)        # 轻微震动
CG(scene2,1,0.5)      # 淡入新场景
```

---

## 🐛 调试技巧

### Unity Console日志

执行CG和SHAKE命令时会输出日志：

```
执行震动: 强度=30, 时长=0.5秒, 次数=10
震动目标未设置，请在Inspector中设置震动目标
```

### 常见问题

**Q: 震动没有效果？**
- 检查Inspector中是否设置了震动目标
- 确保震动目标是RectTransform
- 检查Console是否有警告信息

**Q: CG切换没有淡入淡出效果？**
- 检查是否使用了类型0（无效果）
- 确保Image组件存在
- 检查时长是否太短（小于0.1秒）

**Q: 震动太剧烈或太轻微？**
- 调整强度参数（5-50范围）
- 调整震动次数（影响频率）
- 调整持续时间

---

## 📚 快速参考

### CG命令速查
```
CG(图片)           → 默认淡出淡入，0.5秒
CG(图片,0)         → 无效果，立即切换
CG(图片,1)         → 仅淡入
CG(图片,2)         → 仅淡出
CG(图片,3)         → 淡出后淡入
CG(图片,3,1.0)     → 淡出后淡入，1秒
```

### SHAKE命令速查
```
SHAKE()            → 默认：强度20，0.5秒，10次
SHAKE(30)          → 强度30
SHAKE(40,1.0)      → 强度40，1秒
SHAKE(50,0.8,15)   → 强度50，0.8秒，15次
```

### 常用组合
```
# 战斗冲击
SOUND(hit)+SHAKE(25,0.3)

# 大爆炸
SOUND(explosion)+SHAKE(50,0.6,12)+CG(explosion_effect,1,0.3)

# 场景切换
CG(new_scene,3,1.0)+MUSIC(new_bgm)

# 地震
SOUND(rumble,1)+SHAKE(35,2.0,20)
```

---

## ✅ 总结

- ✅ CG支持4种淡入淡出效果
- ✅ 可自定义淡入淡出时长
- ✅ 支持画面震动效果
- ✅ 震动参数完全可自定义
- ✅ 可与音效、音乐等命令组合使用
- ✅ 基于DOTween实现，性能优秀

享受更加生动的剧本演出效果吧！🎉

